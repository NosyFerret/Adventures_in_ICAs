(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17938,        419]
NotebookOptionsPosition[     17653,        404]
NotebookOutlinePosition[     18037,        421]
CellTagsIndexPosition[     17994,        418]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetSystemOptions", "[", 
   RowBox[{"\"\<MKLThreads\>\"", "\[Rule]", "1"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetSystemOptions", "[", 
    RowBox[{"\"\<ParallelOptions\>\"", "\[Rule]", 
     RowBox[{"\"\<ParallelThreadNumber\>\"", "\[Rule]", "1"}]}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timesteps", "=", "150"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"k_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k", "!"}], ")"}], "^", 
    RowBox[{"k", "^", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}]}], "/", 
   RowBox[{"k", "^", "n"}]}]}], "\n", 
 RowBox[{
  RowBox[{"fun", "[", 
   RowBox[{"alpha_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "g", ",", "gp"}], "}"}], ",", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"Tuples", "[", 
       RowBox[{"alpha", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", "x", "}"}]}], "]"}], ",", 
                RowBox[{"-", "n"}]}], "]"}]}], "}"}]}], "]"}], ",", "alpha"}],
          "]"}], "&"}], "/@", "t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"DirectedEdge", "@@@", 
       RowBox[{"Join", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{"StringJoin", ",", "g", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}]}]}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"seq", "[", "u_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tk", "}"}], ",", 
    RowBox[{
     RowBox[{"tk", "=", 
      RowBox[{"u", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "@@", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"First", "@", "tk"}], "}"}], "~", "Join", "~", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"#", ",", 
            RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Rest", "@", "tk"}]}], ")"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grp", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{"fun", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<0\>\"", ",", "\"\<1\>\"", ",", "\"\<2\>\""}], "}"}], ",", 
      "4"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"FindHamiltonianCycle", "[", 
    RowBox[{"grp", ",", "200"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dbseq", "=", 
   RowBox[{"seq", "/@", "ham"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dbseq2", "=", 
   RowBox[{"IntegerDigits", "/@", 
    RowBox[{"ToExpression", "[", "dbseq", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dbseq5", "=", 
    RowBox[{"dbseq2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "100"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllMRs", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"blackgrey11subrule", "=", 
    RowBox[{"AllMRs", "[", 
     RowBox[{"[", "r", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "ONE", " ", "GR"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ruleloop", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"releventCA", "=", 
        RowBox[{"{", 
         RowBox[{
         "30", ",", "45", ",", "73", ",", "110", ",", "150", ",", "105", ",", 
          "54", ",", "22", ",", "60", ",", "146", ",", "126", ",", "62", ",", 
          "90", ",", "18", ",", "122", ",", "26", ",", "154", ",", "94", ",", 
          "41", ",", "57", ",", "156", ",", "28", ",", "58", ",", "78", ",", 
          "178", ",", "77", ",", "50", ",", "13", ",", "25", ",", "37", ",", 
          "9", ",", "35", ",", "106", ",", "3", ",", "27", ",", "43", ",", 
          "184", ",", "56", ",", "11", ",", "142", ",", "14", ",", "134", ",",
           "24", ",", "7", ",", "152", ",", "170", ",", "46", ",", "15", ",", 
          "33", ",", "1", ",", "42", ",", "162", ",", "6", ",", "5", ",", 
          "138", ",", "38", ",", "10", ",", "74", ",", "34", ",", "29", ",", 
          "130", ",", "2", ",", "204", ",", "200", ",", "172", ",", "108", 
          ",", "76", ",", "72", ",", "51", ",", "44", ",", "104", ",", "232", 
          ",", "140", ",", "132", ",", "23", ",", "12", ",", "164", ",", "36",
           ",", "19", ",", "4", ",", "168", ",", "40", ",", "160", ",", "136",
           ",", "128", ",", "32", ",", "8", ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rulecombinations", "=", 
        RowBox[{
         RowBox[{"Sort", "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{"releventCA", ",", "2"}], "]"}]}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"rules", "=", 
        RowBox[{"rulecombinations", "[", 
         RowBox[{"[", "l", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "rulestuff", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rule1", "=", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rule2", "=", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rulelabels", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"i", ",", "2", ",", "8"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "255"}], "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"subrules", "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", "3"}], "]"}], "]"}]}], ";", 
       "\n", 
       RowBox[{"ruletable1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Rule", "@@@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"subrules", ",", 
              RowBox[{"rulelabels", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "256"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ruletable2", "=", 
        RowBox[{"ruletable1", "/.", " ", 
         RowBox[{"1", "\[Rule]", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pureruletable", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"ruletable1", "[", 
           RowBox[{"[", 
            RowBox[{"rule1", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"ruletable2", "[", 
           RowBox[{"[", 
            RowBox[{"rule2", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rulelabelsmixed", "=", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "2"}], "}"}], ",", "3"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rulelabelsmixed2", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"rulelabelsmixed", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], 
                "\[Equal]", "True"}], "&&", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"rulelabelsmixed", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], 
                "\[Equal]", "True"}]}], ",", 
              RowBox[{"rulelabelsmixed", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "rulelabelsmixed", "]"}]}], "}"}]}], 
           "]"}], ",", "Null"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"masterrule11", "=", 
        RowBox[{"Rule", "@@@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"rulelabelsmixed2", ",", "blackgrey11subrule"}], "}"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ruletable", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"pureruletable", ",", "masterrule11"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"icloop", "=", 
        RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"IC", "=", 
            RowBox[{"dbseq5", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\n", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"CA", " ", "stuff"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"state", "=", "IC"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CompetingCAs", "=", "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Reap", "[", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sow", "[", "state", "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rICpar", "=", 
                    RowBox[{"Partition", "[", 
                    RowBox[{"state", ",", "3", ",", "1"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"state", "=", 
                    RowBox[{"ArrayPad", "[", 
                    RowBox[{
                    RowBox[{"rICpar", "/.", "ruletable"}], ",", "1"}], 
                    "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "timesteps"}], "}"}]}], "]"}], 
                "]"}], "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "measure", " ", "the", " ", "complexity", " ", "values", " ", 
              "for", " ", "only", " ", "the", " ", "last", " ", "50", " ", 
              "time", " ", "steps"}], ",", " ", 
             RowBox[{
             "to", " ", "approximate", " ", "the", " ", "asymp", 
              "\[IndentingNewLine]", "Using", " ", "only", " ", "ONE", " ", 
              "segment"}], ",", " ", 
             RowBox[{"ignoring", " ", "areas"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"complexityvalues", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"compression", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Compress", "[", 
                   RowBox[{"CompetingCAs", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}], "//", 
                  "ByteCount"}], ")"}], "-", "80"}]}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "101", ",", "150"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"complexityplot", "=", 
            RowBox[{
             RowBox[{"Total", "[", "complexityvalues", "]"}], "/", 
             "4000"}]}]}], 
          RowBox[{"(*", 
           RowBox[{"80", "*", "50"}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "100"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "3916"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<GR_\>\"", "<>", 
     RowBox[{"ToString", "[", "r", "]"}], "<>", "\"\<.out\>\""}], ",", 
    "ruleloop", ",", "\"\<Table\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.638900649134675*^9, 3.6389006731309958`*^9}, {
   3.6389007670933332`*^9, 3.638900792853725*^9}, {3.6389008267145033`*^9, 
   3.638900855165874*^9}, {3.638900899500544*^9, 3.638900950249654*^9}, 
   3.6389009915688887`*^9, {3.638901030367495*^9, 3.6389010518228703`*^9}, {
   3.638901156325431*^9, 3.638901233953041*^9}, 3.638901290909287*^9, 
   3.638901323635292*^9, {3.638901400328549*^9, 3.638901401627078*^9}, {
   3.638901434737701*^9, 3.638901568354403*^9}, {3.638901621072402*^9, 
   3.638901658428006*^9}, 3.6389018379550457`*^9, {3.638903621375581*^9, 
   3.638903651115343*^9}, {3.6389036927232113`*^9, 3.638903743547385*^9}, {
   3.6389037799922523`*^9, 3.638903780190399*^9}, {3.638903875765284*^9, 
   3.638904017717267*^9}, {3.638904073930627*^9, 3.638904101153412*^9}, {
   3.638904146318873*^9, 3.638904147102997*^9}, {3.638904374632115*^9, 
   3.638904433436125*^9}, {3.638904527761297*^9, 3.638904530416112*^9}, {
   3.638904600165895*^9, 3.638904601573887*^9}, {3.638913902203271*^9, 
   3.6389139036572447`*^9}, {3.638913935823071*^9, 3.638913951720661*^9}, 
   3.638920431332239*^9, {3.639067231083364*^9, 3.639067241693701*^9}, {
   3.639195141229953*^9, 3.639195278858151*^9}, {3.6391954618406677`*^9, 
   3.639195464220372*^9}, {3.639595650248905*^9, 3.6395956510948963`*^9}, {
   3.639596258995323*^9, 3.63959639142854*^9}, {3.6395965854628572`*^9, 
   3.6395965882685337`*^9}, {3.639597580030623*^9, 3.639597594021747*^9}, {
   3.63959778511021*^9, 3.639597809808691*^9}, {3.63959784244184*^9, 
   3.639597865630793*^9}, {3.639599791254302*^9, 3.639599792788145*^9}, {
   3.639600454260741*^9, 3.639600458297739*^9}, {3.6396007753937483`*^9, 
   3.639600778210346*^9}, {3.639601001311986*^9, 3.639601007016395*^9}, {
   3.6396365681872883`*^9, 3.639636661437964*^9}, {3.6396370519719667`*^9, 
   3.639637075097061*^9}, {3.639637287800233*^9, 3.639637327269246*^9}, {
   3.639638341428523*^9, 3.639638380932604*^9}, 3.639638420827537*^9, {
   3.6396661098787413`*^9, 3.639666148463928*^9}, 3.639666268044855*^9, {
   3.639666312141164*^9, 3.639666318899295*^9}, {3.643372174512843*^9, 
   3.64337217798344*^9}, {3.643372376392129*^9, 3.643372395654298*^9}, {
   3.643372434098096*^9, 3.643372435239694*^9}, {3.643372685785918*^9, 
   3.643372686631136*^9}, 3.643372781679988*^9, {3.643372876352665*^9, 
   3.6433729093560143`*^9}, {3.643372942687193*^9, 3.643373078438534*^9}, {
   3.643373208606574*^9, 3.643373211190099*^9}, {3.643373341753364*^9, 
   3.643373379888975*^9}, {3.643373412633554*^9, 3.6433734210638733`*^9}, {
   3.643373677738806*^9, 3.6433737031211967`*^9}, {3.6433737819897738`*^9, 
   3.643373791403324*^9}, {3.64337392277847*^9, 3.6433739515262136`*^9}, {
   3.6433739923584213`*^9, 3.643374007900168*^9}, {3.643374186749824*^9, 
   3.643374211274671*^9}, {3.643374283061854*^9, 3.6433742842358847`*^9}, {
   3.643374528568919*^9, 3.643374545236865*^9}, {3.6433745824537783`*^9, 
   3.643374629542613*^9}, {3.643374675182111*^9, 3.6433746891875067`*^9}, 
   3.643374754062958*^9, 3.643374867113092*^9, {3.643375053214004*^9, 
   3.643375054103815*^9}, 3.64337527545728*^9, 3.643375320043516*^9, {
   3.643375540822466*^9, 3.643375550820093*^9}, {3.643375599556429*^9, 
   3.643375603193695*^9}, {3.6433757283779173`*^9, 3.643375729502968*^9}, {
   3.643376102853157*^9, 3.6433761052119207`*^9}, {3.643376283217155*^9, 
   3.643376290254023*^9}, {3.643376418244285*^9, 3.643376503420999*^9}, {
   3.6433765601718693`*^9, 3.643376600777614*^9}, {3.643376639259001*^9, 
   3.643376643294148*^9}, {3.643376750558997*^9, 3.6433767512594223`*^9}, {
   3.643376794658289*^9, 3.643376795208337*^9}, {3.6433768990001497`*^9, 
   3.643376940694653*^9}, {3.643376974162403*^9, 3.643376991008277*^9}, {
   3.6433770522129393`*^9, 3.6433771036300497`*^9}, {3.643377219720788*^9, 
   3.6433772790126534`*^9}}]
},
EvaluationCompletionAction->{},
WindowSize->{808, 651},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 17091, 382, 1406, "Input"]
}
]
*)

(* End of internal cache information *)
